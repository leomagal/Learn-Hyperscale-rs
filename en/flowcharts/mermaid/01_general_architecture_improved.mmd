graph TB
    subgraph "Network Layer"
        NET["ğŸŒ P2P Network<br/>Gossip Protocol"]
    end
    
    subgraph "Production Layer"
        PROD["ğŸ­ Production Runtime<br/>Thread Pool Specialization"]
    end
    
    NET -->|Events| NODE
    PROD -->|Executes| NODE
    
    subgraph "Node Layer"
        NODE["ğŸ–¥ï¸ NodeStateMachine<br/>Main Orchestrator"]
    end
    
    NODE -->|Coordinates| BFT
    NODE -->|Coordinates| EXEC
    NODE -->|Coordinates| MEMPOOL
    NODE -->|Coordinates| PROV
    NODE -->|Coordinates| LIVELOCK
    
    subgraph "Main Components"
        BFT["ğŸ”· BFT State Machine<br/>HotStuff-2 Consensus<br/>- Vote Locking<br/>- Unlock Rule<br/>- View Sync"]
        EXEC["ğŸŸ¢ Execution Engine<br/>Transaction Execution<br/>- Jellyfish Merkle Tree<br/>- State Root"]
        MEMPOOL["ğŸŸ¡ Mempool<br/>Transaction Pool<br/>- Conflict Detection<br/>- Categorization<br/>- Ready/Deferred"]
        PROV["ğŸŸ£ Provisioning<br/>Block Preparation<br/>- Collect Txs<br/>- Order Txs"]
        LIVELOCK["ğŸŸ  Livelock Prevention<br/>Cycle Detection<br/>- Deadlock Detection<br/>- Retry Logic"]
    end
    
    BFT -->|Uses| TYPES
    EXEC -->|Uses| TYPES
    MEMPOOL -->|Uses| TYPES
    
    subgraph "Data Layer"
        TYPES["ğŸ“‹ Types & Structures<br/>- Hash<br/>- Block<br/>- Vote<br/>- QC"]
        CRYPTO["ğŸ” Cryptography<br/>- BLS12-381<br/>- Blake3<br/>- Ed25519"]
        STORAGE["ğŸ’¾ Storage<br/>- State Root<br/>- Ledger<br/>- Transactions"]
    end
    
    TYPES -->|Validates| CRYPTO
    CRYPTO -->|Protects| STORAGE
    
    style NODE fill:#ff6b6b,stroke:#c92a2a,color:#fff
    style BFT fill:#4dabf7,stroke:#1971c2,color:#fff
    style EXEC fill:#51cf66,stroke:#2f9e44,color:#fff
    style MEMPOOL fill:#ffd43b,stroke:#f59f00,color:#000
    style PROV fill:#da77f2,stroke:#9c36b5,color:#fff
    style LIVELOCK fill:#ff8787,stroke:#fa5252,color:#fff
